<!DOCTYPE html>
<html>
<head>
    <title>AI Career Advisor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}

body{
min-height:100vh;
background:linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#0575e6);
background-size:400% 400%;
animation:gradientMove 15s ease infinite;
overflow-x:hidden;
}

@keyframes gradientMove{
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}

nav{
position:fixed;
top:0;
width:100%;
background:rgba(255,255,255,0.1);
backdrop-filter:blur(20px);
border-bottom:1px solid rgba(255,255,255,0.2);
z-index:1000;
padding:15px 0;
}

.nav-container{
max-width:1200px;
margin:0 auto;
padding:0 20px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logo{
font-size:24px;
font-weight:700;
color:#fff;
text-shadow:2px 2px 8px rgba(0,0,0,0.3);
}

.nav-links{
display:flex;
gap:30px;
list-style:none;
}

.nav-links a{
color:#fff;
text-decoration:none;
font-weight:500;
transition:all 0.3s ease;
padding:8px 16px;
border-radius:8px;
}

.nav-links a:hover{
background:rgba(255,255,255,0.2);
transform:translateY(-2px);
}

.hero{
min-height:100vh;
display:flex;
align-items:center;
justify-content:center;
text-align:center;
padding:100px 20px 60px;
}

.hero-content{
max-width:800px;
animation:fadeIn 0.8s ease;
}

.hero h1{
font-size:56px;
color:#fff;
margin-bottom:20px;
text-shadow:3px 3px 15px rgba(0,0,0,0.3);
line-height:1.2;
}

.hero p{
font-size:20px;
color:rgba(255,255,255,0.9);
margin-bottom:40px;
line-height:1.6;
}

.cta-btn{
padding:18px 45px;
font-size:18px;
font-weight:700;
background:linear-gradient(135deg,#00d2ff,#3a7bd5);
color:#fff;
border:none;
border-radius:50px;
cursor:pointer;
transition:all 0.3s ease;
box-shadow:0 8px 30px rgba(0,210,255,0.4);
}

.cta-btn:hover{
transform:translateY(-3px);
box-shadow:0 12px 40px rgba(0,0,0,0.4);
}

section{
padding:80px 20px;
max-width:1200px;
margin:0 auto;
}

.section-title{
text-align:center;
font-size:42px;
color:#fff;
margin-bottom:50px;
text-shadow:2px 2px 10px rgba(0,0,0,0.2);
}

.features{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
gap:30px;
margin-top:40px;
}

.feature-card{
background:rgba(255,255,255,0.1);
backdrop-filter:blur(20px);
border:1px solid rgba(255,255,255,0.2);
border-radius:20px;
padding:35px;
text-align:center;
transition:all 0.3s ease;
}

.feature-card:hover{
transform:translateY(-10px);
background:rgba(255,255,255,0.15);
box-shadow:0 10px 40px rgba(0,0,0,0.3);
}

.feature-icon{
font-size:48px;
margin-bottom:20px;
}

.feature-card h3{
color:#fff;
font-size:22px;
margin-bottom:15px;
}

.feature-card p{
color:rgba(255,255,255,0.8);
line-height:1.6;
}

.container{
max-width:900px;
width:100%;
margin:0 auto;
padding:50px;
background:rgba(255,255,255,0.1);
backdrop-filter:blur(20px);
border-radius:30px;
box-shadow:0 8px 32px rgba(0,0,0,0.3);
border:1px solid rgba(255,255,255,0.2);
animation:fadeIn 0.6s ease;
}

footer{
background:rgba(0,0,0,0.3);
backdrop-filter:blur(20px);
color:#fff;
text-align:center;
padding:30px 20px;
border-top:1px solid rgba(255,255,255,0.1);
}

.footer-content{
max-width:1200px;
margin:0 auto;
}

.footer-links{
display:flex;
justify-content:center;
gap:30px;
margin-bottom:15px;
flex-wrap:wrap;
}

.footer-links a{
color:rgba(255,255,255,0.8);
text-decoration:none;
transition:color 0.3s ease;
}

.footer-links a:hover{
color:#fff;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(30px);}
to{opacity:1;transform:translateY(0);}
}

h2{
text-align:center;
margin-bottom:35px;
color:#fff;
font-size:32px;
font-weight:700;
text-shadow:2px 2px 10px rgba(0,0,0,0.2);
letter-spacing:1px;
}

.upload-box{
border:2px dashed rgba(255,255,255,0.4);
padding:30px;
border-radius:20px;
margin-bottom:25px;
background:rgba(255,255,255,0.15);
text-align:center;
transition:all 0.3s ease;
position:relative;
overflow:hidden;
}

.upload-box:hover{
border-color:rgba(255,255,255,0.7);
background:rgba(255,255,255,0.2);
transform:translateY(-2px);
box-shadow:0 5px 20px rgba(0,0,0,0.2);
}

.upload-box.drag-over{
border-color:#4facfe;
background:rgba(79,172,254,0.2);
transform:scale(1.02);
}

.upload-box label{
display:block;
font-size:16px;
font-weight:600;
color:#fff;
margin-bottom:15px;
text-shadow:1px 1px 3px rgba(0,0,0,0.2);
}

.preview-wrapper{
position:relative;
width:160px;
height:160px;
margin:0 auto 15px;
transition:transform 0.3s ease;
}

.preview-wrapper:hover{
transform:scale(1.05);
}

.preview-wrapper img{
width:160px;
height:160px;
border-radius:50%;
object-fit:cover;
border:4px solid rgba(255,255,255,0.8);
box-shadow:0 8px 25px rgba(0,0,0,0.3);
transition:all 0.3s ease;
}

.remove-btn{
position:absolute;
top:-5px;
right:-5px;
background:linear-gradient(135deg,#ff6b6b,#ee5a6f);
color:white;
border:none;
border-radius:50%;
width:32px;
height:32px;
cursor:pointer;
font-size:16px;
box-shadow:0 4px 15px rgba(238,90,111,0.4);
transition:all 0.3s ease;
z-index:10;
}

.remove-btn:hover{
transform:rotate(90deg) scale(1.1);
box-shadow:0 6px 20px rgba(238,90,111,0.6);
}

.hidden{display:none;}

input[type="file"]{
padding:12px;
background:rgba(255,255,255,0.9);
border-radius:12px;
border:none;
width:100%;
font-size:14px;
cursor:pointer;
transition:all 0.3s ease;
}

input[type="file"]:hover{
background:rgba(255,255,255,1);
box-shadow:0 4px 15px rgba(0,0,0,0.1);
}

#resumeName{
margin-top:12px;
font-size:14px;
color:#fff;
font-weight:500;
background:rgba(255,255,255,0.2);
padding:8px 15px;
border-radius:8px;
display:inline-block;
}

button[type="submit"]{
width:100%;
padding:18px;
border-radius:15px;
border:none;
font-weight:700;
font-size:18px;
background:linear-gradient(135deg,#00d2ff,#3a7bd5);
color:white;
cursor:pointer;
margin-top:20px;
transition:all 0.4s ease;
box-shadow:0 8px 25px rgba(0,210,255,0.4);
position:relative;
overflow:hidden;
}

button[type="submit"]:hover{
transform:translateY(-3px) scale(1.02);
box-shadow:0 12px 35px rgba(0,210,255,0.6);
}

button[type="submit"]:active{
transform:translateY(-1px);
}

.loading{
pointer-events:none;
opacity:0.7;
}

.loading::after{
content:'';
position:absolute;
top:0;
left:-100%;
width:100%;
height:100%;
background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
animation:loading 1.5s infinite;
}

@keyframes loading{
to{left:100%;}
}

#results{
margin-top:40px;
padding:0;
border-radius:25px;
background:rgba(255,255,255,0.95);
display:none;
border:none;
box-shadow:0 10px 40px rgba(0,0,0,0.2);
animation:slideUp 0.5s ease;
}

@keyframes slideUp{
from{opacity:0;transform:translateY(30px);}
to{opacity:1;transform:translateY(0);}
}

.results-header{
background:linear-gradient(135deg,#0575e6,#021b79);
padding:30px;
border-radius:25px 25px 0 0;
text-align:center;
animation:headerPulse 2s ease infinite;
}

@keyframes headerPulse{
0%,100%{box-shadow:0 0 20px rgba(5,117,230,0.5);}
50%{box-shadow:0 0 40px rgba(5,117,230,0.8);}
}

.results-header h2{
color:#fff;
margin:0;
font-size:28px;
}

.results-content{
padding:35px;
}

.info-card{
background:linear-gradient(135deg,#e0f7ff,#b3e5fc);
padding:20px 25px;
border-radius:15px;
margin-bottom:20px;
border-left:5px solid #0575e6;
box-shadow:0 4px 15px rgba(0,0,0,0.1);
transition:all 0.3s ease;
animation:cardSlideIn 0.5s ease forwards;
opacity:0;
}

@keyframes cardSlideIn{
from{opacity:0;transform:translateX(-30px);}
to{opacity:1;transform:translateX(0);}
}

.info-card:hover{
transform:translateX(10px) scale(1.02);
box-shadow:0 8px 25px rgba(5,117,230,0.3);
}

.info-card strong{
color:#0575e6;
font-size:16px;
display:block;
margin-bottom:8px;
}

.chart-container{
background:#fff;
padding:25px;
border-radius:15px;
margin:25px 0;
box-shadow:0 4px 20px rgba(0,0,0,0.08);
}

.chart-container h3{
color:#0575e6;
margin-bottom:20px;
font-size:20px;
padding-bottom:10px;
border-bottom:3px solid #00d2ff;
animation:titleGlow 2s ease infinite;
}

@keyframes titleGlow{
0%,100%{text-shadow:0 0 10px rgba(5,117,230,0.3);}
50%{text-shadow:0 0 20px rgba(5,117,230,0.6);}
}

#results canvas{
max-width:100%;
height:280px !important;
}

#downloadBtn{
width:100%;
padding:16px;
background:linear-gradient(135deg,#00b4db,#0083b0);
margin-bottom:25px;
border-radius:12px;
font-size:16px;
font-weight:600;
transition:all 0.3s ease;
box-shadow:0 6px 20px rgba(0,180,219,0.4);
animation:btnFloat 3s ease infinite;
}

@keyframes btnFloat{
0%,100%{transform:translateY(0);}
50%{transform:translateY(-5px);}
}

#downloadBtn:hover{
transform:translateY(-8px) scale(1.02);
box-shadow:0 12px 35px rgba(0,180,219,0.6);
}

.advice-list{
background:linear-gradient(135deg,#d4fc79,#96e6a1);
padding:20px 25px;
border-radius:15px;
margin-top:20px;
box-shadow:0 4px 15px rgba(0,0,0,0.1);
animation:fadeInUp 0.8s ease;
}

@keyframes fadeInUp{
from{opacity:0;transform:translateY(20px);}
to{opacity:1;transform:translateY(0);}
}

.advice-list ul{
margin-top:10px;
padding-left:20px;
}

.advice-list li{
margin:10px 0;
color:#333;
line-height:1.6;
}

.pdf-export-mode{
font-size:11px!important;
line-height:1.5!important;
background:#fff!important;
color:#000!important;
padding:20px!important;
border:none!important;
animation:none!important;
box-shadow:none!important;
}

.pdf-export-mode *{
animation:none!important;
backdrop-filter:none!important;
transform:none!important;
}

.pdf-export-mode .results-header{
background:#0575e6!important;
animation:none!important;
box-shadow:none!important;
padding:20px!important;
}

.pdf-export-mode .results-header h2{
font-size:20px!important;
}

.pdf-export-mode .info-card{
opacity:1!important;
animation:none!important;
background:#e0f7ff!important;
transform:none!important;
page-break-inside:avoid;
}

.pdf-export-mode .chart-container{
page-break-inside:avoid;
background:#fff!important;
}

.pdf-export-mode .chart-container h3{
animation:none!important;
text-shadow:none!important;
font-size:16px!important;
}

.pdf-export-mode .advice-list{
page-break-inside:avoid;
}

.pdf-export-mode h3,.pdf-export-mode p,.pdf-export-mode strong,.pdf-export-mode li{
color:#000!important;
}

.pdf-export-mode canvas{
max-width:100%!important;
height:auto!important;
}

.pdf-export-mode #downloadBtn{
display:none!important;
}

.page-break{page-break-before:always;}

@media print{
*{animation:none!important;transform:none!important;transition:none!important;}
body{background:white!important;margin:0;padding:0;}
body *{visibility:hidden;}
#results,#results *{visibility:visible;}
#results{position:absolute;left:0;top:0;width:100%;box-shadow:none!important;animation:none!important;margin:0!important;border-radius:0!important;}
nav,footer,.container,section,#downloadBtn,.modal,.hero,.features,#about,#analyzer>*:not(#results){display:none!important;}
.results-header{background:#0575e6!important;color:white!important;print-color-adjust:exact;-webkit-print-color-adjust:exact;page-break-after:avoid;}
.results-content{background:white!important;}
.info-card{background:#e0f7ff!important;print-color-adjust:exact;-webkit-print-color-adjust:exact;opacity:1!important;page-break-inside:avoid;border-left:5px solid #0575e6!important;}
.chart-container{page-break-inside:avoid;background:white!important;}
.advice-list{page-break-inside:avoid;background:#d4fc79!important;print-color-adjust:exact;-webkit-print-color-adjust:exact;}
canvas{max-width:100%!important;height:auto!important;}
#downloadBtn{display:none!important;}
}

.dashboard-selector{
padding:30px 40px;
background:rgba(255,255,255,0.1);
backdrop-filter:blur(20px);
border:2px solid rgba(255,255,255,0.3);
border-radius:20px;
color:#fff;
font-size:18px;
font-weight:600;
cursor:pointer;
transition:all 0.3s ease;
min-width:200px;
}

.dashboard-selector:hover{
transform:translateY(-5px) scale(1.05);
background:rgba(255,255,255,0.2);
box-shadow:0 10px 30px rgba(0,210,255,0.4);
}

.dashboard-selector.active{
background:linear-gradient(135deg,#00d2ff,#3a7bd5);
border-color:#00d2ff;
box-shadow:0 8px 25px rgba(0,210,255,0.5);
transform:scale(1.05);
}

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.8);
backdrop-filter:blur(10px);
display:none;
justify-content:center;
align-items:center;
z-index:2000;
animation:fadeInModal 0.3s ease;
}

@keyframes fadeInModal{
from{opacity:0;}
to{opacity:1;}
}

.modal.show{
display:flex;
}

.modal-content{
background:rgba(255,255,255,0.95);
backdrop-filter:blur(20px);
border-radius:30px;
max-width:500px;
width:90%;
max-height:90vh;
overflow-y:auto;
box-shadow:0 20px 60px rgba(0,0,0,0.5);
animation:popIn 0.4s cubic-bezier(0.68,-0.55,0.265,1.55);
position:relative;
}

@keyframes popIn{
from{transform:scale(0.5) translateY(-100px);opacity:0;}
to{transform:scale(1) translateY(0);opacity:1;}
}

.modal.closing .modal-content{
animation:popOut 0.3s ease forwards;
}

@keyframes popOut{
from{transform:scale(1) translateY(0);opacity:1;}
to{transform:scale(0.5) translateY(100px);opacity:0;}
}

.modal-header{
background:linear-gradient(135deg,#0575e6,#021b79);
padding:25px;
border-radius:30px 30px 0 0;
text-align:center;
position:relative;
}

.modal-header h2{
color:#fff;
margin:0;
font-size:24px;
}

.modal-close{
position:absolute;
top:15px;
right:15px;
background:rgba(255,255,255,0.2);
border:none;
color:#fff;
font-size:24px;
width:35px;
height:35px;
border-radius:50%;
cursor:pointer;
transition:all 0.3s ease;
}

.modal-close:hover{
background:rgba(255,255,255,0.3);
transform:rotate(90deg);
}

.modal-body{
padding:30px;
}

.modal-options{
display:grid;
grid-template-columns:1fr 1fr;
gap:20px;
margin-top:20px;
}

.modal-option{
background:linear-gradient(135deg,#e0f7ff,#b3e5fc);
border:2px solid #0575e6;
border-radius:20px;
padding:30px 20px;
text-align:center;
cursor:pointer;
transition:all 0.3s ease;
}

.modal-option:hover{
transform:translateY(-5px) scale(1.05);
box-shadow:0 10px 30px rgba(5,117,230,0.3);
background:linear-gradient(135deg,#0575e6,#021b79);
}

.modal-option:hover .modal-option-icon{
transform:scale(1.2) rotate(10deg);
}

.modal-option:hover h3,
.modal-option:hover p{
color:#fff;
}

.modal-option-icon{
font-size:48px;
margin-bottom:15px;
transition:all 0.3s ease;
}

.modal-option h3{
color:#0575e6;
font-size:20px;
margin-bottom:10px;
transition:color 0.3s ease;
}

.modal-option p{
color:#333;
font-size:14px;
line-height:1.5;
transition:color 0.3s ease;
}

@media(max-width:768px){
.nav-links{display:none;}
.hero h1{font-size:36px;}
.hero p{font-size:16px;}
.section-title{font-size:32px;}
.container{padding:30px 20px;}
h2{font-size:24px;}
.upload-box{padding:20px;}
.dashboard-selector{min-width:150px;padding:20px 30px;font-size:16px;}
.modal-options{grid-template-columns:1fr;}
.modal-content{width:95%;}
}
</style>
</head>

<body>
<div id="landingPage">
<nav>
<div class="nav-container">
<div class="logo">üöÄ CareerAI</div>
<ul class="nav-links">
<li><a href="#home">Home</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#about">About</a></li>
</ul>
</div>
</nav>

<section id="home" class="hero">
<div class="hero-content">
<h1>üéØ Discover Your Perfect Career Path</h1>
<p>AI-powered career analysis that helps you understand your skills, personality traits, and find the ideal career match tailored just for you.</p>
<button class="cta-btn" onclick="openModal()">Get Started Now ‚Üí</button>
</div>
</section>

<section id="features">
<h2 class="section-title">Why Choose CareerAI?</h2>
<div class="features">
<div class="feature-card">
<div class="feature-icon">ü§ñ</div>
<h3>AI-Powered Analysis</h3>
<p>Advanced algorithms analyze your resume and profile to provide accurate career recommendations.</p>
</div>
<div class="feature-card">
<div class="feature-icon">üìä</div>
<h3>Detailed Insights</h3>
<p>Get comprehensive reports with skill distribution, career matches, and personality traits.</p>
</div>
<div class="feature-card">
<div class="feature-icon">üéØ</div>
<h3>Personalized Advice</h3>
<p>Receive tailored career guidance and skill development recommendations.</p>
</div>
<div class="feature-card">
<div class="feature-icon">üì•</div>
<h3>PDF Reports</h3>
<p>Download professional career analysis reports to share or keep for reference.</p>
</div>
<div class="feature-card">
<div class="feature-icon">‚ö°</div>
<h3>Instant Results</h3>
<p>Get your career analysis in seconds with our fast processing technology.</p>
</div>
<div class="feature-card">
<div class="feature-icon">üîí</div>
<h3>Secure & Private</h3>
<p>Your data is protected with enterprise-grade security and privacy measures.</p>
</div>
</div>
</section>

<section id="about">
<h2 class="section-title">About CareerAI</h2>
<div style="max-width:800px;margin:0 auto;text-align:center;">
<p style="color:rgba(255,255,255,0.9);font-size:18px;line-height:1.8;margin-bottom:20px;">
CareerAI is an innovative platform that leverages artificial intelligence to help professionals discover their ideal career paths. Our advanced algorithms analyze your skills, experience, and personality traits to provide personalized career recommendations.
</p>
<p style="color:rgba(255,255,255,0.9);font-size:18px;line-height:1.8;">
Whether you're a recent graduate, career changer, or looking to advance in your field, CareerAI provides the insights you need to make informed decisions about your professional future.
</p>
</div>
</section>

<footer>
<div class="footer-content">
<div class="footer-links">
<a href="#home">Home</a>
<a href="#features">Features</a>
<a href="#about">About</a>
<a href="#">Privacy Policy</a>
<a href="#">Terms of Service</a>
</div>
<p style="color:rgba(255,255,255,0.7);margin-top:15px;">&copy; 2024 CareerAI. All rights reserved.</p>
</div>
</footer>
</div>

<div id="dashboardPage" style="display:none;min-height:100vh;padding:100px 20px 40px;">
<div style="max-width:1200px;margin:0 auto;">
<button onclick="location.reload()" style="background:rgba(255,255,255,0.2);color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;margin-bottom:20px;">‚Üê Back to Home</button>

<form id="uploadForm">

<div class="upload-box" id="photoBox">
<label>üì∏ Upload Profile Photo</label>
<div class="preview-wrapper">
<img id="photoPreview" src="https://via.placeholder.com/160/667eea/ffffff?text=Photo">
<button type="button" id="removePhotoBtn" class="remove-btn hidden">‚úñ</button>
</div>
<input type="file" id="profile_image" accept="image/*" required>
</div>

<div class="upload-box" id="resumeBox">
<label>üìÑ Upload Resume (PDF)</label>
<input type="file" id="resume" accept=".pdf" required>
<p id="resumeName"></p>
<button type="button" id="removeResumeBtn" class="remove-btn hidden">‚úñ</button>
</div>

<button type="submit" id="submitBtn">‚ú® Analyze My Career Path</button>
</form>

<div id="results">
<div class="results-header">
<h2>üìä Your Career Analysis Report</h2>
</div>
<div class="results-content">
<div class="info-card" id="statusText"></div>
<div class="info-card" id="careerText"></div>
<div class="info-card" id="personalityText"></div>

<div class="page-break"></div>

<div class="chart-container">
<h3>üìä Skill Distribution</h3>
<canvas id="skillsChart"></canvas>
</div>

<div class="chart-container">
<h3>üéØ Career Match Scores</h3>
<canvas id="careerChart"></canvas>
</div>

<div class="info-card" id="missingSkillsText"></div>
<div class="advice-list" id="adviceText"></div>

<button id="downloadBtn">üì• Download PDF Report</button>
</div>
</div>
</div>
</div>
</body>

<script>
let skillsChartInstance;
let careerChartInstance;

const photoInput=document.getElementById("profile_image");
const photoPreview=document.getElementById("photoPreview");
const removePhotoBtn=document.getElementById("removePhotoBtn");

const resumeInput=document.getElementById("resume");
const resumeName=document.getElementById("resumeName");
const removeResumeBtn=document.getElementById("removeResumeBtn");

/* DRAG & DROP */
const photoBox=document.getElementById('photoBox');
const resumeBox=document.getElementById('resumeBox');

[photoBox,resumeBox].forEach(box=>{
box.addEventListener('dragover',e=>{e.preventDefault();box.classList.add('drag-over');});
box.addEventListener('dragleave',()=>box.classList.remove('drag-over'));
box.addEventListener('drop',e=>{
e.preventDefault();
box.classList.remove('drag-over');
const input=box.querySelector('input[type="file"]');
if(e.dataTransfer.files.length){
input.files=e.dataTransfer.files;
input.dispatchEvent(new Event('change'));
}
});
});

/* PHOTO PREVIEW */
photoInput.addEventListener("change",function(){
const file=this.files[0];
if(file){
const reader=new FileReader();
reader.onload=e=>{
photoPreview.src=e.target.result;
removePhotoBtn.classList.remove("hidden");
};
reader.readAsDataURL(file);
}
});

removePhotoBtn.onclick=()=>{
photoPreview.src="https://via.placeholder.com/160/667eea/ffffff?text=Photo";
photoInput.value="";
removePhotoBtn.classList.add("hidden");
};

/* üìÑ RESUME PREVIEW */
resumeInput.addEventListener("change",function(){
if(this.files.length>0){
resumeName.textContent=this.files[0].name;
removeResumeBtn.classList.remove("hidden");
}
});

removeResumeBtn.onclick=()=>{
resumeInput.value="";
resumeName.textContent="";
removeResumeBtn.classList.add("hidden");
};

/* FORM SUBMIT */
const submitBtn=document.getElementById('submitBtn');
document.getElementById('uploadForm').onsubmit=async(e)=>{
e.preventDefault();

submitBtn.classList.add('loading');
submitBtn.textContent='üîÑ Analyzing...';

const formData=new FormData();
formData.append('resume',resumeInput.files[0]);
formData.append('profile_image',photoInput.files[0]);

try{
const response=await fetch('/analyze',{method:'POST',body:formData});
const result=await response.json();

submitBtn.classList.remove('loading');
submitBtn.textContent='‚ú® Analyze My Career Path';

if(result.status==="success"){
document.getElementById('results').style.display='block';
document.getElementById('results').scrollIntoView({behavior:'smooth',block:'start'});

document.getElementById('statusText').innerHTML=
`<strong>üíº Skills Found</strong><div style="margin-top:8px;color:#333;">${Object.entries(result.skill_counts).map(([s,c])=>`<span style="display:inline-block;background:#667eea;color:#fff;padding:5px 12px;border-radius:20px;margin:4px;font-size:13px;">${s} (${c})</span>`).join("")}</div>`;

document.getElementById('careerText').innerHTML=
`<strong>üéØ Suggested Career</strong><div style="margin-top:8px;color:#333;font-size:18px;font-weight:600;">${result.suggested_career}</div>
<div style="margin-top:12px;color:#555;font-size:14px;">Match Scores: ${Object.entries(result.career_scores).map(([c,s])=>`${c} (${s}%)`).join(", ")}</div>`;

document.getElementById('personalityText').innerHTML=
`<strong>‚ú® Personality Traits</strong><div style="margin-top:8px;color:#333;">${(result.personality_traits||[]).map(t=>`<span style="display:inline-block;background:linear-gradient(135deg,#f093fb,#f5576c);color:#fff;padding:5px 12px;border-radius:20px;margin:4px;font-size:13px;">${t}</span>`).join("")}</div>`;

document.getElementById('missingSkillsText').innerHTML=
`<strong>üìö Skills to Develop for ${result.suggested_career}</strong><div style="margin-top:8px;color:#333;">${(result.missing_skills||[]).map(s=>`<span style="display:inline-block;background:#ffecd2;color:#333;padding:5px 12px;border-radius:20px;margin:4px;font-size:13px;border:2px dashed #fcb69f;">${s}</span>`).join("")}</div>`;

document.getElementById('adviceText').innerHTML=
`<strong style="color:#333;font-size:18px;">üí° Career Advice</strong><ul>${(result.advice||[]).map(a=>`<li>${a}</li>`).join("")}</ul>`;

/* SKILLS CHART */
const ctx1=document.getElementById('skillsChart').getContext('2d');
if(skillsChartInstance)skillsChartInstance.destroy();
skillsChartInstance=new Chart(ctx1,{
type:'bar',
data:{labels:Object.keys(result.skill_counts),
datasets:[{label:'Skill Count',data:Object.values(result.skill_counts),
backgroundColor:'rgba(102,126,234,0.8)',borderColor:'rgba(102,126,234,1)',borderWidth:2,borderRadius:8}]},
options:{responsive:true,plugins:{legend:{display:true,labels:{font:{size:14}}}},scales:{y:{beginAtZero:true,ticks:{stepSize:1},grid:{color:'rgba(0,0,0,0.05)'}},x:{grid:{display:false}}}}
});

/* CAREER CHART */
const ctx2=document.getElementById('careerChart').getContext('2d');
if(careerChartInstance)careerChartInstance.destroy();
careerChartInstance=new Chart(ctx2,{
type:'bar',
data:{labels:Object.keys(result.career_scores),
datasets:[{label:'Career Match %',data:Object.values(result.career_scores),
backgroundColor:'rgba(240,147,251,0.8)',borderColor:'rgba(240,147,251,1)',borderWidth:2,borderRadius:8}]},
options:{responsive:true,plugins:{legend:{display:true,labels:{font:{size:14}}}},scales:{y:{beginAtZero:true,min:0,max:100,grid:{color:'rgba(0,0,0,0.05)'}},x:{grid:{display:false}}}}
});

}else{
alert("Error: "+result.error);
}
}catch(err){
submitBtn.classList.remove('loading');
submitBtn.textContent='‚ú® Analyze My Career Path';
alert("Error: "+err.message);
}
};

/* PDF DOWNLOAD */
document.getElementById('downloadBtn').onclick=async function(){
const btn=this;
btn.disabled=true;
btn.textContent='üîÑ Generating PDF...';

try{
const element=document.getElementById('results');

// Store original styles
const originalStyles=new Map();
const allElements=[element,...element.querySelectorAll('*')];

allElements.forEach(el=>{
originalStyles.set(el,{
animation:el.style.animation,
transform:el.style.transform,
opacity:el.style.opacity,
backdropFilter:el.style.backdropFilter
});
el.style.animation='none';
el.style.transform='none';
el.style.opacity='1';
el.style.backdropFilter='none';
});

// Hide download button
btn.style.display='none';

await new Promise(resolve=>setTimeout(resolve,500));

const canvas=await html2canvas(element,{
scale:3,
useCORS:true,
allowTaint:true,
backgroundColor:'#ffffff',
logging:false,
width:element.scrollWidth,
height:element.scrollHeight
});

const imgData=canvas.toDataURL('image/png',1.0);
const {jsPDF}=window.jspdf;
const pdf=new jsPDF('p','mm','a4');

const pdfWidth=pdf.internal.pageSize.getWidth();
const pdfHeight=pdf.internal.pageSize.getHeight();
const imgWidth=canvas.width;
const imgHeight=canvas.height;
const ratio=pdfWidth/imgWidth;
const scaledHeight=imgHeight*ratio;

let position=0;
let pageHeight=pdfHeight;

while(position<scaledHeight){
if(position>0)pdf.addPage();
pdf.addImage(imgData,'PNG',0,-position,pdfWidth,scaledHeight);
position+=pageHeight;
}

pdf.save('Career_Analysis_Report.pdf');

// Restore original styles
allElements.forEach(el=>{
const styles=originalStyles.get(el);
el.style.animation=styles.animation;
el.style.transform=styles.transform;
el.style.opacity=styles.opacity;
el.style.backdropFilter=styles.backdropFilter;
});

btn.style.display='block';
btn.disabled=false;
btn.textContent='üì• Download PDF Report';
}catch(err){
console.error('PDF Error:',err);
alert('Error generating PDF: '+err.message);
btn.disabled=false;
btn.textContent='üì• Download PDF Report';
}
};

function openModal(){
document.getElementById('landingPage').style.display='none';
document.getElementById('dashboardPage').style.display='block';
window.scrollTo(0,0);
}

function closeModal(){
// Not used anymore
}

function startAnalysis(){
// Not used anymore
}
</script>
</body>
</html>